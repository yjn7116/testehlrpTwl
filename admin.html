<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>관리자 페이지</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: 60px auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    input, button {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
    }
    #admin-section {
      display: none;
    }
  </style>
</head>
<body>
  <h2>관리자 로그인</h2>
  <div id="login-section">
    <input type="text" id="username" placeholder="아이디" />
    <input type="password" id="password" placeholder="비밀번호" />
    <button onclick="login()">로그인</button>
  </div>

  <div id="admin-section">
    <h3>현재 주제: <span id="current-topic">불러오는 중...</span></h3>
    <input type="text" id="new-topic" placeholder="새 주제를 입력하세요" />
    <button onclick="updateTopic()">주제 변경</button>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCFq__DB_6TnNVUG4Z3De7vpRnxynn8MjE",
      authDomain: "debateshop-cbeb4.firebaseapp.com",
      databaseURL: "https://debateshop-cbeb4-default-rtdb.firebaseio.com",
      projectId: "debateshop-cbeb4",
      storageBucket: "debateshop-cbeb4.appspot.com",
      messagingSenderId: "460568591399",
      appId: "1:460568591399:web:e462862283d9ee69e16202"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // 로그인
    function login() {
      const id = document.getElementById('username').value;
      const pw = document.getElementById('password').value;
      if (id === 'admin' && pw === 'admin') {
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('admin-section').style.display = 'block';
        loadCurrentTopic();
      } else {
        alert("아이디 또는 비밀번호가 틀렸습니다");
      }
    }

    // 현재 주제 로드
    function loadCurrentTopic() {
      const topicRef = ref(db, 'topic');
      onValue(topicRef, (snapshot) => {
        const val = snapshot.val();
        document.getElementById('current-topic').textContent = val || '(없음)';
      });
    }

    // 주제 업데이트
    function updateTopic() {
      const newTopic = document.getElementById('new-topic').value;
      if (newTopic.trim() === '') {
        alert('주제를 입력하세요');
        return;
      }
      set(ref(db, 'topic'), newTopic);
      document.getElementById('new-topic').value = '';
    }
  </script>
</body>
</html>